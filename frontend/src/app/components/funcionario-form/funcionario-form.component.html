<p-toast></p-toast>

<div class="card p-4 shadow-lg rounded-lg max-w-lg mx-auto">
  <h2 class="text-2xl font-bold mb-6 text-center">{{ pageTitle }}</h2>

  <form [formGroup]="funcionarioForm" (ngSubmit)="onSubmit()" class="p-fluid">

    <div class="field mb-4">
      <label for="nome" class="font-semibold block mb-2">Nome Completo</label>
      <input id="nome" type="text" pInputText formControlName="nome" placeholder="Nome Completo" [class.ng-invalid]="f['nome'].invalid && f['nome'].touched">
      
      <small class="p-error block mt-1" 
             *ngIf="f['nome'].invalid && f['nome'].touched">
        <span *ngIf="f['nome'].errors?.['required']">O nome é obrigatório.</span>
        <span *ngIf="f['nome'].errors?.['minlength']">O nome deve ter no mínimo 3 caracteres (Regra 3.5).</span>
        <span *ngIf="f['nome'].errors?.['whitespace']">O nome não pode ser apenas espaços em branco (Regra 3.5).</span>
      </small>
    </div>

    <div class="field mb-4">
      <label for="email" class="font-semibold block mb-2">E-mail</label>
      <input id="email" type="email" pInputText formControlName="email" placeholder="nome@dominio.com" [class.ng-invalid]="f['email'].invalid && f['email'].touched">
      <small class="p-error block mt-1" 
             *ngIf="f['email'].invalid && f['email'].touched">
        <span *ngIf="f['email'].errors?.['required']">O e-mail é obrigatório.</span>
        <span *ngIf="f['email'].errors?.['email']">O e-mail deve ser um formato válido (Regra 3.5).</span>
        <span *ngIf="f['email'].errors?.['whitespace']">O e-mail não pode ser apenas espaços em branco (Regra 3.5).</span>
      </small>
    </div>

    <div class="field mb-4">
      <label for="cargo" class="font-semibold block mb-2">Cargo/Função</label>
      <input id="cargo" type="text" pInputText formControlName="cargo" placeholder="Cargo" [class.ng-invalid]="f['cargo'].invalid && f['cargo'].touched">
      <small class="p-error block mt-1" 
             *ngIf="f['cargo'].invalid && f['cargo'].touched">
        <span *ngIf="f['cargo'].errors?.['required']">O cargo é obrigatório.</span>
        <span *ngIf="f['cargo'].errors?.['whitespace']">O cargo não pode ser apenas espaços em branco (Regra 3.5).</span>
      </small>
    </div>

    <div class="field mb-4">
      <label for="salario" class="font-semibold block mb-2">Salário Atual</label>
      <p-inputNumber 
        id="salario" 
        formControlName="salario" 
        mode="currency" 
        currency="BRL" 
        locale="pt-BR"
        [min]="0.01"
        [showButtons]="false"
        placeholder="R$ 0,00"
        [class.ng-invalid]="f['salario'].invalid && f['salario'].touched">
      </p-inputNumber>
      <small class="p-error block mt-1" 
             *ngIf="f['salario'].invalid && f['salario'].touched">
        <span *ngIf="f['salario'].errors?.['required']">O salário é obrigatório.</span>
        <span *ngIf="f['salario'].errors?.['min']">O salário deve ser um valor positivo e maior que zero (Regra 3.1).</span>
      </small>
    </div>

    <div class="field mb-6">
      <label for="dataAdmissao" class="font-semibold block mb-2">Data de Admissão</label>
      <p-calendar 
        id="dataAdmissao" 
        formControlName="dataAdmissao" 
        dateFormat="dd/mm/yy" 
        [showIcon]="true" 
        placeholder="Selecione a data"
        [class.ng-invalid]="f['dataAdmissao'].invalid && f['dataAdmissao'].touched">
      </p-calendar>
      <small class="p-error block mt-1" 
             *ngIf="f['dataAdmissao'].invalid && f['dataAdmissao'].touched">
        <span *ngIf="f['dataAdmissao'].errors?.['required']">A data de admissão é obrigatória.</span>
        <span *ngIf="f['dataAdmissao'].errors?.['dateFuture']">A data não pode ser futura (Regra 3.1).</span>
      </small>
    </div>

    <div class="flex justify-end gap-3 pt-4 border-t border-gray-100">
      <button type="button" class="btn btn-secondary" (click)="cancelar()">Cancelar</button>
      <p-button type="submit" [label]="isEditMode ? 'Atualizar' : 'Salvar'" [disabled]="funcionarioForm.invalid || funcionarioForm.disabled"></p-button>
    </div>

  </form>
</div>
